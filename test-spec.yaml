# syntax=bkpkg:mariner2
name: moby-tini
version: "v0.19.0"
website: "https://github.com/krallin/tini"
dependencies:
  build:
    - cmake
    - glibc-static
sources:
  tini:
    ref: 'git://github.com/krallin/tini#v0.19.0'
  legal:
    ref: 'local://tmp/licenses'
    path: 'tmp/licenses'
buildSteps:
  - mounts:
      tini: /build/src
      legal: /build/legal
    workdir: /build/src
    steps:
      - command: mkdir -vp build
      - command: |
          set -ex

          cd build
          cmake ..
          make tini-static
    outputs:
      /usr/bin/docker-init:
        type: exe
        includes:
          - /build/src/build/tini-static
      /usr/share/doc/moby-tini/LICENSE:
        type: text
        includes:
          - /build/legal/LICENSE
      /usr/share/doc/moby-tini/NOTICE:
        type: text
        includes:
          - /build/legal/NOTICE
description: |
  Tini is the simplest init you could think of.
  .
  All Tini does is spawn a single child (Tini is meant to be run in a
  container), and wait for it to exit all the while reaping zombies and
  performing signal forwarding.
